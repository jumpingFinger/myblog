<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="[toc] ##week five ###事件  1.什么是事件?  事件就是一件事情或者一个行为 (对于元素来说 ,它的很多事情都是天生自带的) , 只要我们去操作这个元素 , 就会触发这些行为, (不管你在JS中是否进行了某些操作,行为本身是存在的,只要我们操作元素,就会触发其相关事件)  事件: 事件就是元素天生再带的行为 , 我们操作元素 , 就会触发相关的事件行为`  事件绑定 : 给元">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/2018/05/14/week five/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="[toc] ##week five ###事件  1.什么是事件?  事件就是一件事情或者一个行为 (对于元素来说 ,它的很多事情都是天生自带的) , 只要我们去操作这个元素 , 就会触发这些行为, (不管你在JS中是否进行了某些操作,行为本身是存在的,只要我们操作元素,就会触发其相关事件)  事件: 事件就是元素天生再带的行为 , 我们操作元素 , 就会触发相关的事件行为`  事件绑定 : 给元">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/2OZ]YFOOU2S11KIQ%60GPIH.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/cb402153-1376-47b3-bf63-a95a733f96bb.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/1525840405181.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/1525840457189.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/1525840550140.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/U%60Q8VQW$AS2Z8[TO@2%7DUZ5Y.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/2%7BN%60FSL_M3V%7BJY6EA3ORU.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/1526180317986.png">
<meta property="og:image" content="http://yoursite.com/2018/05/14/week%20five/1526196324951.png">
<meta property="og:updated_time" content="2018-05-14T08:36:24.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="[toc] ##week five ###事件  1.什么是事件?  事件就是一件事情或者一个行为 (对于元素来说 ,它的很多事情都是天生自带的) , 只要我们去操作这个元素 , 就会触发这些行为, (不管你在JS中是否进行了某些操作,行为本身是存在的,只要我们操作元素,就会触发其相关事件)  事件: 事件就是元素天生再带的行为 , 我们操作元素 , 就会触发相关的事件行为`  事件绑定 : 给元">
<meta name="twitter:image" content="http://yoursite.com/2018/05/14/week%20five/2OZ]YFOOU2S11KIQ%60GPIH.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-week five" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/14/week five/" class="article-date">
  <time datetime="2018-05-14T09:52:17.625Z" itemprop="datePublished">2018-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<p>##week five</p>
<p>###事件</p>
<blockquote>
<p>1.什么是事件?</p>
<ul>
<li>事件就是一件事情或者一个行为 (对于元素来说 ,它的很多事情都是天生自带的) , 只要我们去操作这个元素 , 就会触发这些行为, (不管你在JS中是否进行了某些操作,行为本身是存在的,只要我们操作元素,就会触发其相关事件)</li>
</ul>
<p><code>事件</code>: <strong>事件就是元素天生再带的行为 , 我们操作元素 , 就会触发相关的事件行为`</strong></p>
<ol start="2">
<li><code>事件绑定</code> : 给元素天生自带的事件行为绑定方法 ,当事件触发 , 会把对应的方法执行了 ,在标准浏览器还传递了参数(ev)</li>
</ol>
<ul>
<li><code>oBox.onclcik=function () {}</code> </li>
<li><code>oBox.addEventListener(&#39;onxxx&#39;,functon (){},false)</code></li>
</ul>
<ol start="3">
<li>元素天生自带的事件 ?  </li>
</ol>
<p>[鼠标事件]<br>  <code>click</code>: 点击  (<strong><code>click是事件行为</code></strong> (click是复合行为,把底层的down和up先搞了)) PC端是<code>点击</code> , 移动端的click代表<code>单击(在一定时间内点击)</code> [移动端使用click会有300MS延迟的问题]  //=&gt; <code>onclick是点击的时候做什么</code></p>
<p><code>dblclick</code> : 双击<br><code>mouseover</code> :  鼠标经过 (飘过)<br><code>mouseout</code> : 鼠标移出<br><code>mouseenter</code>:  鼠标进入  (进入)<br><code>mouseleave</code> : 鼠标离开<br><code>mousemove</code> :  鼠标移动<br><code>mousedown</code> :鼠标按下 (鼠标左右键都起作用,它是按下即触发,click是按下抬起才会触发,而且顺序是先把 up 和down 都触发了 ,才会触发click)<br><code>mouseup</code> : 鼠标抬起<br><code>mousewheel</code>: 鼠标滚轮滚动</p>
<p> <code>mousedown -&gt; mouseup -&gt; onclcik-&gt;mousedown -&gt; mouseup -&gt; onclcik-&gt;dblonclick</code>  </p>
<p><code>mouseover -&gt;mouseenter-&gt;mouseout -&gt; mouseleave</code> //=&gt;over 跟out 永远在enter和leave之前</p>
<p>[键盘事件]<br><code>keydown</code> :按下键盘触发<br><code>keyup</code> : 松开键盘时触发该事件<br><code>keypress</code> :  和keydown类似 ,只不过<code>keydown返回的是键盘码(按小写的来)</code> ,<code>keypress返回的是ASCII码值(按大写的来)</code> , 按下有值的键时触发,即按下ctrl , alt , shift ,meta 这样无值的键 ,这个事件就不会触发 ,对于有值的键 , 按下时先触发keydown事件,按下时触发keydown事件,再触发该事件</p>
<p>[移动端内容改变事件]<br> input : 由于PC端是实体物理键盘,可以监听到键盘的按下和抬起 ,但是移动端是虚拟的键盘 , 所以keydown和keyup在大部分手机上都没有,我们使用<code>input</code>事件统一代替他们 (<code>内容改变事件</code>)<br>  <code>userNameBox.oninput=function (){};</code></p>
<blockquote>
<p> [移动端单手指事件]<br><code>touchstart</code> : 手机按下<br><code>touchmove</code> : 手指移动<br><code>touchend</code>: 手指离开<br><code>touchcancel</code> : 因为意外情况导致手机操作取消 (手机意外关机) </p>
</blockquote>
<p>  [gesture : 多手指操作]<br><code>gesturestart</code> : 多手指按下<br><code>gesturechange</code> : 手指改变<br><code>getstureend</code>: 手指离开  </p>
<p> [表单元素常用的事件]<br> <code>focus</code>: 获取焦点<br> <code>blur</code>: 失去焦点<br> <code>change</code>: 内容改变  </p>
<p> [其他常用事件]<br> <code>load</code> : 加载完成<br> <code>unload</code> :<br> <code>beforenunload</code><br> <code>scroll</code> : 滚动条滚动事件<br> <code>resize</code>: 大小改变事件  <code>window.onresize=function (){}</code>;<br> <code>error</code><br> <code>onreadystatechange</code> : ajax状态改变</p>
<p>[H5中的AUDIO/VIDEO音视频事件]<br><code>canplay</code> : 可以播放 (播放过程中可能出现由于资源没有加载完成 ,导致的卡顿)<br><code>canplaythrough</code> : 资源加载完成,可以正常无障碍播放<br>…  </p>
<p> [其他事件]<br> 调取手机的重力感应<br> 调取手机的GPS定位</p>
</blockquote>
<p>###事件绑定 (事件对象 ev/e)</p>
<blockquote>
<p>[DOM0事件绑定]<br><code>[element].onxxx=function (){}</code><br>[DOM2级事件绑定]<br><code>[element].addEventListener(&#39;xxx&#39;,function (){},false)</code>;<br><code>[element].attachEvent(&#39;onxxx&#39;,function (){});[IE6-8]</code> </p>
<p>[目的]<br>给当前元素的 某个事件绑定方法 (不管是基于DOM0还是DOM2) , 都是为了触发元素的相关行为的时候 , 能做点事情 (也就是把绑定的方法执行) : “不仅把方法执行了,而且浏览器还给方法传递了一个实参信息值” //=&gt;&gt;&gt;这个值就是<strong><code>事件对象</code></strong> , 浏览器会把这个对象传递给执行的方法 , 我们可以在方法中通过形参或者实参集合等方式接收到</p>
<p>事件对象中记录了很多属性名和属性值 , 这些信息中包含了当前操作的基础信息 , 例如 : 鼠标点击位置的x/y轴左边,鼠标点击的是谁 (事件源) 等信息<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">box.onclcik=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//=&gt;定义一个形参EV用来接收方法执行的时候,浏览器传递的信息值 (事件对象) (MouseEvent 鼠标事件对象) , keyboardEvent 键盘对象 , Event普通事件对象 , TouchEvent (触摸事件对象)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><strong><code>//=&gt;自己dir看看原型链</code></strong></p>
<p>###鼠标事件对象 (MouseEvent)<br><code>ev.target =&gt;事件源 (操作的是哪个元素)</code><br><code>ev.clientX \ clientY</code> :  当前鼠标触发点距离当前窗口左上角X/Y轴坐标<br><code>ev.pageX/pageY</code> :  当前鼠标触发点距离body (第一屏幕)左上角的X/Y距离<br><code>ev.preventDefault();</code>阻止默认行为<br><code>ev.stopPropagation</code> : 阻止事件的冒泡传播<br><img src="./2OZ]YFOOU2S11KIQ`GPIH.png" alt="Alt text"><br><code>ev.path</code> :  记录事件传播的路径<br><code>type</code> : 当前事件类型</p>
<p>###键盘事件对象 (keyboardEvent)<br><code>ev.code</code> :当前按键’keyE’ ;<br><code>ev.key</code>  :  当前按键 <code>e</code><br><code>ev.which / ev.keyCode</code> : 当前按键的键盘码  69  兼容问题()//=&gt;<code>let code = ev.which ||ev.keyCode</code><br>[常用的键盘码]</p>
<blockquote>
<p>左上右下 : 38 -39 -40 -37<br>Backspace : 8<br>Eneter : 13<br>space : 32<br>Delete : 46<br>Shift : 16<br>Alt : 18<br>Ctrl : 17<br>F1 ~ F12  : 112 - 123<br>ESC : 27<br>0~9 : 48 - 57<br>小写字母 :  65~90</p>
</blockquote>
<p><img src="./cb402153-1376-47b3-bf63-a95a733f96bb.png" alt="Alt text"></p>
<p>###IE的兼容处理 </p>
<blockquote>
<p>低版本中没有属性 , 我们手动设置一下 , 按照自己的先获取到值,然后复制给和标准对应的新属性 (经过判断处理后,低版本中也有target/pageX/pageY)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">box.onclick=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">      <span class="comment">//=&gt;在IE低版本浏览器中吗,浏览器执行绑定的方法,并没有把事件对象传递进来,此时ev =undefined , 需要机遇window.event来获取  (由于是全局属性,鼠标每次操作都会把上一次操作的值替换掉)</span></span><br><span class="line">      ev=ev ||<span class="built_in">window</span>.event;</span><br><span class="line">      ev.target=ev.target ||ev.srcElement; <span class="comment">//=&gt;srcElement 是获取事件源</span></span><br><span class="line">      <span class="built_in">console</span>.log(ev.type);<span class="comment">//都有</span></span><br><span class="line">      <span class="built_in">console</span>.log(ev.clientX);<span class="comment">//都有</span></span><br><span class="line">      <span class="built_in">console</span>.log(ev.pageX);<span class="comment">//低版本浏览器的时间对象中不存在pageX/pageY</span></span><br><span class="line">      ev.pageX=ev.clientX+(<span class="built_in">document</span>.documentElement.scrollLeft ||<span class="built_in">document</span>.body.scrollLeft);</span><br><span class="line">      ev.pageY=ev.clientY+(<span class="built_in">document</span>.documentElement.scrollTop ||<span class="built_in">document</span>.body.scrollTop);</span><br><span class="line">      ev.which=ev.keyCode;</span><br><span class="line">      ev.preventDefault=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">          ev.returnValue=<span class="literal">false</span>; <span class="comment">//=&gt;阻止低版本默认行为</span></span><br><span class="line">      &#125;;</span><br><span class="line">      ev.stopPropagation=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">          ev.cancelBubble=<span class="literal">true</span>;  <span class="comment">//=&gt;阻止他的冒泡传播</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="built_in">console</span>.log(ev);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>封装<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleEvent</span>=<span class="title">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">	 <span class="keyword">if</span> (!ev || !ev.target) &#123;</span><br><span class="line">        ev = <span class="built_in">window</span>.event;</span><br><span class="line">        ev.target = ev.srcElement;</span><br><span class="line">        ev.pageX = ev.clientX + (<span class="built_in">document</span>.documentElement.scrollLeft || <span class="built_in">document</span>.body.scrollLeft);</span><br><span class="line">        ev.pageY = ev.clientY + (<span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop);</span><br><span class="line">        ev.which = ev.keyCode;</span><br><span class="line">        ev.preventDefault = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            ev.returnValue = <span class="literal">false</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        ev.stopPropagation = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            ev.cancelBubble = <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ev</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>###事件的默认行为 </p>
<blockquote>
<p>事件的默认行为 :  事件本身就是天生就有的 , 某些事情触发 ,即使你没有绑定方法 ,也会存在一些效果 . 这些默认的效果就是 “事件的默认行为”<br>//=&gt;A标签的点击操作就存在默认行为 </p>
</blockquote>
<p><code>A标签的默认行为</code></p>
<blockquote>
<ol>
<li>页面跳转</li>
<li>锚点定位 (hash定位 (哈希定位)) //=&gt;基于HASH值我们还可以实现SPA单页面应用<br><img src="./1525840405181.png" alt="Alt text"><br><img src="./1525840457189.png" alt="Alt text"><br><img src="./1525840550140.png" alt="Alt text"></li>
</ol>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*      &lt;a href="http://www.zhufengpeixun.cn/" target="_blank"&gt;</span><br><span class="line"> *          珠峰培训</span><br><span class="line"> *      &lt;/a&gt;</span><br><span class="line"> *      target=<span class="string">'_blank'</span>：让其在新窗口打开</span><br><span class="line"> *</span><br><span class="line"> *      &lt;a href="#box"&gt;珠峰培训&lt;/a&gt; 首先会在当前页面URL地址栏末尾设置一个HASH值，浏览器检测到HASH值后，会默认定位到当前页面中ID和HASH相同的盒子的位置（基于HASH值我们还可以实现SPA单页面应用）</span><br><span class="line"> *</span><br></pre></td></tr></table></figure>
<p><code>input标签的默认行为</code></p>
<blockquote>
<ol>
<li>输入内容可以呈现到文本框中</li>
<li>输入内容的时候会把之前输入的一些信息呈现出来 (并不是所有浏览器和所有情况下都有)<br>//=&gt;真实项目中我们可能会阻止文本框输入内容 ,其实就是在阻止它的默认行为</li>
</ol>
</blockquote>
<p><code>submit</code></p>
<blockquote>
<ol>
<li>点击按钮页面会刷新<br>//=&gt;在form中设置action , 点击submit ,会默认按照action指定的地址进行页面跳转 , 并且把表单中的信息传递过去  (非前后端分离的项目中,由于服务器进行页面渲染.由于其他语言实现数据交互 , 一般都是这样处理)<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"http://www.zhufengpeixun.cn/"</span>&gt;</span><br><span class="line">   &lt;input type=<span class="string">"submit"</span> value=<span class="string">"提交"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<p>####如何阻止A标签的默认行为</p>
<blockquote>
<ol>
<li>阻止A标签的默认行为 : 很多时候我们使用A标签仅仅是想当做一个普通的按钮 ,点击实现一个功能 , 也不想页面跳转.也不像锚点定位</li>
</ol>
</blockquote>
<blockquote>
<p>在结构中阻止<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:;&quot; id=&quot;link&quot;&gt;&lt;/a&gt; //=&gt;放代表假的就没问题 (viod(0) ,undefined,null)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>在JS中阻止<br>给其click事件绑定方法,当我们点击A标签的时候,先触发click事件,其次才会执行自己的默认行为<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">link.onclick=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">	ev=ev||<span class="built_in">window</span>.event;</span><br><span class="line">	ev.preventDefault?ev.preventDefault():ev.returnValue=<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">link.onclick=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">	ev=ev||<span class="built_in">window</span>.event;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">temInp.onkeydown=temInp.onkeyup=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">let</span> val=<span class="keyword">this</span>.value.trim(),<span class="comment">//=&gt;trim去除字符串首尾空格(不兼容)</span></span><br><span class="line">	len=val.length;</span><br><span class="line">	<span class="keyword">if</span>(len&gt;=<span class="number">6</span>)&#123;</span><br><span class="line">		<span class="keyword">this</span>.value=val.substr(<span class="number">0.6</span>);</span><br><span class="line">		<span class="comment">//=&gt;阻止默认行为去除\特殊按键(delete/backspace/方向键/alt/shift/ctrl/tab)</span></span><br><span class="line">		<span class="keyword">let</span> code=ev.which||ev.keyCode</span><br><span class="line">		<span class="keyword">if</span>(! <span class="regexp">/^([37-40]|46|8|9|[16-18])/</span>.test(code))&#123;</span><br><span class="line">		   ev.preventDefault?ev.preventDefault():ev.returnValue=<span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>###事件传播机制 (重点!!!!!)<br><code>捕获阶段</code></p>
<blockquote>
<p>点击inner的时候,首先会让最外层开始向内查找 , 查找的目的是 ,<code>构建出冒泡阶段传播阶段需要传播的路线</code> (查找就是按照HTML层级结构找的)</p>
</blockquote>
<p><code>目标阶段</code></p>
<blockquote>
<p>把事件源的相关操作行为触发 (如果绑定了方法,则把方法执行)</p>
</blockquote>
<p><code>冒泡传播</code></p>
<blockquote>
<p>触发当前元素的某一个事件行为 (点击事件),不仅当前元素事件行为触发 ,而且其祖先元素的相关事件行为也会一次被触发 , 这种机制就是”事件的冒泡传播机制”<br>demo : 下面从里到外依次触发<br><code>事件分为 事件行为本身 和绑定的事件</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(<span class="string">'document'</span>);</span><br><span class="line">     &#125;;</span><br><span class="line">    <span class="built_in">document</span>.documentElement.onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'html'</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    outer.onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'outer'</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    inner.onclcik=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'inner'</span>);</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<blockquote>
<p>在Event.prototype<br>0 : NONE      什么都没做<br>1 :capturing _phase     捕获阶段<br>2 : at_target     目标阶段<br>3 : bubblng_phase     冒泡阶段</p>
</blockquote>
<blockquote>
<p>DOM0事件绑定,给元素的事件行为绑定方法 , 这些方法都是在当前元素事件行为的冒泡阶段 (或者目标阶段)执行的</p>
<p>DOM2 第三个参数false也是控制绑定方法在事件传播的冒泡阶段 (或者目标阶段)执行; 只有第三个参数为true才代表让当前方法在事件传播的捕获阶段触发执行 (这种捕获阶段执行没啥实际意义 ,项目中很少用)</p>
</blockquote>
<p><code>不同浏览器对于最外层祖先元素的定义不一样</code><br>谷歌 : window - document - html - body …<br>IE : window - html - body …<br>IE低 : html - body ….</p>
<p>###关于事件对象的一些理解</p>
<ol>
<li>事件对象是用来存储当前本次操作的相关信息 , 和操作有关 , 和元素无必然关联 </li>
<li>当我们基于鼠标或者键盘等操作的时候 , 浏览器会把本次操作的信息存储起来  (标准浏览器存储到默认的内存中(自己找不到)), IE低版本存储到 window.event 中了) ,存储的值是一个对象 (堆内存) : 操作肯定会触发元素的某个行为 ,把绑定的方法执行 , 此时标准浏览器会把之前存储的对象 (准确来说是堆内存地址)当做实参传递给每一个执行的方法 ,所以操作一次,即使再多方法中都有ev, 但是存储的值都是一个 (本次操作的信息的对象而已)</li>
</ol>
<p>###mouseenter 和mouseover 区别</p>
<ol>
<li>over属性滑过 (覆盖)事件 , 从父元素进入到子元素 ,属于离开了父元素,会触发父元素的out , 触发了元素的over<br>enter属于进入 ,从父元素进入子元素 , 并不算离开父元素 ,不会触发父元素的leave ,触发子元素的enter </li>
<li>enter 和leave阻止了事件的冒泡传播 ,而over 和out 还存在冒泡传播的 </li>
</ol>
<blockquote>
<p>所以对于父元素嵌套子元素的这种情况 . 使用over 会发生很多不愿意操作的事情,此时我们使用enter会更加简单 , 操作方便 , 所以真实项目中enter的使用会比over 多   </p>
</blockquote>
<p>###事件委托</p>
<blockquote>
<p>利用事件的冒泡传播机制,如果一个容器的后代元素当中,很多元素的(<code>相同的行为</code>)点击行为 (其他行为也是)都要做一些处理,此时我们不需要在像以前一样一个个获取一个个绑定了.我们只需要给容器的clcik绑定方法即可, 这样不管点击的是哪一个后代元素 , 都会根据冒泡传播的传递机制 ,把容器的click行为触发 , 把对应的方法执行 ,根据事件源,我们可以知道点击的是谁 , 从未做不同的事情即可 </p>
<p>基于事件委托绑定轮播图的左右箭头和检点事件<br>事件委托的用处 :</p>
<ul>
<li>1.容器中很多后代元素的某个行为要进行操作,委托给容器处理是不错的选择</li>
<li>2.元素是动态绑定的</li>
<li>3.需求是除了某某某,剩下的操作都是干同样的事情  (此时把点击行为的操作委托body,)事件源是某某做什么 , 不是统一做什么<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//=&gt;基于事件委托实现左右切换和焦点切换</span></span><br><span class="line"><span class="keyword">let</span> queryIndex = <span class="function"><span class="keyword">function</span> <span class="title">queryIndex</span>(<span class="params">ele</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//=&gt;先获取它的所有哥哥，有几个哥哥它的索引就是几</span></span><br><span class="line">    <span class="keyword">let</span> ary = [],</span><br><span class="line">        pre = ele.previousElementSibling;</span><br><span class="line">    <span class="keyword">while</span> (pre) &#123;</span><br><span class="line">        ary.unshift(pre);</span><br><span class="line">        pre = pre.previousElementSibling</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ary.length;</span><br><span class="line">&#125;;</span><br><span class="line">container.onclick = <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> target = ev.target,</span><br><span class="line">        tag = target.tagName,</span><br><span class="line">        par = target.parentNode;</span><br><span class="line">    <span class="comment">//=&gt;焦点</span></span><br><span class="line">    <span class="keyword">if</span> (tag === <span class="string">'LI'</span> &amp;&amp; par.className.indexOf(<span class="string">'focus'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        stepIndex = queryIndex(target);</span><br><span class="line">        <span class="comment">//=&gt;让STEP-INDEX等于当前点击LI的索引</span></span><br><span class="line">        animate(wrapper, &#123;</span><br><span class="line">            left: -stepIndex * <span class="number">1000</span></span><br><span class="line">        &#125;, <span class="number">200</span>);</span><br><span class="line">        changeFocus();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;左右按钮</span></span><br><span class="line">    <span class="keyword">if</span> (tag === <span class="string">'A'</span> &amp;&amp; target.className.indexOf(<span class="string">'arrow'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (target.className.indexOf(<span class="string">'arrowLeft'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="comment">//=&gt;左</span></span><br><span class="line">            stepIndex--;</span><br><span class="line">            <span class="keyword">if</span> (stepIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                utils.css(wrapper, <span class="string">'left'</span>, -(slideList.length - <span class="number">1</span>) * <span class="number">1000</span>);</span><br><span class="line">                stepIndex = slideList.length - <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            animate(wrapper, &#123;</span><br><span class="line">                left: -stepIndex * <span class="number">1000</span></span><br><span class="line">            &#125;, <span class="number">200</span>);</span><br><span class="line">            changeFocus();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//=&gt;右</span></span><br><span class="line">        autoMove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<p>###实战鼠标跟随<br><img src="./U`Q8VQW$AS2Z8[TO@2}UZ5Y.png" alt="Alt text"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;link rel="stylesheet" href="css/</span>reset.min.css<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">        .container&#123;</span></span><br><span class="line"><span class="string">            position: relative;</span></span><br><span class="line"><span class="string">            margin:20px auto;</span></span><br><span class="line"><span class="string">            width:462px;</span></span><br><span class="line"><span class="string">            height: 77px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .container .imgBox li &#123;</span></span><br><span class="line"><span class="string">            float: left;</span></span><br><span class="line"><span class="string">            margin-right:18px;</span></span><br><span class="line"><span class="string">            width: 100px;</span></span><br><span class="line"><span class="string">            height: 75px;</span></span><br><span class="line"><span class="string">            border: 1px solid #eee;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .container .imgBox li:nth-last-child(1)&#123;</span></span><br><span class="line"><span class="string">            margin-right:0;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .container .imgBox li img&#123;</span></span><br><span class="line"><span class="string">            display: block;</span></span><br><span class="line"><span class="string">            width: 100%;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .container .mark&#123;</span></span><br><span class="line"><span class="string">            position: absolute;</span></span><br><span class="line"><span class="string">            top: 0;</span></span><br><span class="line"><span class="string">            left: 0;</span></span><br><span class="line"><span class="string">            width: 400px;</span></span><br><span class="line"><span class="string">            height: 300px;</span></span><br><span class="line"><span class="string">            border: 1px solid #000;</span></span><br><span class="line"><span class="string">            box-sizing:border-box;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .container .mark img&#123;</span></span><br><span class="line"><span class="string">            display: block;</span></span><br><span class="line"><span class="string">            width: 100%;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;section class="</span>container<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;!--ul.imgBox&gt;li*4&gt;img[src='img/apple_$.jpg']--&gt;</span></span><br><span class="line"><span class="string">    &lt;ul class="</span>imgBox clearfix<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;!--</span></span><br><span class="line"><span class="string">            如果小图和大图在名字上没有固定的规则,我们把大图地址都以自定义属性方式存起来,后期需要展示大图的时候,从自定义属性获取即可,没有固定规则按这种</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            如果有固定的规则,我们完全可以不采用自定义属性的方式,而是基于规则匹配即可</span></span><br><span class="line"><span class="string">        --&gt;</span></span><br><span class="line"><span class="string">        &lt;li&gt;&lt;img src="</span>img/apple_1.jpg<span class="string">"  data-big="</span>img/apple_1_.jpg<span class="string">" alt="</span><span class="string">"&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">        &lt;li&gt;&lt;img src="</span>img/apple_2.jpg<span class="string">" alt="</span><span class="string">"&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">        &lt;li&gt;&lt;img src="</span>img/apple_3.jpg<span class="string">" alt="</span><span class="string">"&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">        &lt;li&gt;&lt;img src="</span>img/apple_4.jpg<span class="string">" alt="</span><span class="string">"&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">    &lt;/ul&gt;</span></span><br><span class="line"><span class="string">    &lt;!--div.mark&gt;img[src='img/apple_1_bigger.jpg']--&gt;</span></span><br><span class="line"><span class="string">    &lt;!--JS动态创建的--&gt;</span></span><br><span class="line"><span class="string">    &lt;!--&lt;div class="</span>mark<span class="string">"&gt;--&gt;</span></span><br><span class="line"><span class="string">        &lt;!--&lt;img src="</span>img/apple_1_bigger.jpg<span class="string">" alt="</span><span class="string">"&gt;--&gt;</span></span><br><span class="line"><span class="string">    &lt;!--&lt;/div&gt;--&gt;</span></span><br><span class="line"><span class="string">&lt;/section&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&lt;!--方案一:</span></span><br><span class="line"><span class="string">      每一个li中都有一个大盒子 , 大盒子中存放的是大图,开始是隐藏的,鼠标进入,让其显示 ,并且让他的位置跟随鼠标的位置改变即可,鼠标离开li让自己的大盒子隐藏即可,类似于放大镜smallBox出现的mark</span></span><br><span class="line"><span class="string">   方案二:</span></span><br><span class="line"><span class="string">    只有一个大盒子(可以在JS中动态创建,也可以事先写好,控制显示隐藏),鼠标进入另一个li,都让大盒子出来 , 并且大盒子中都存放的图片根据当前进入的li动态改变,同样实现鼠标移动跟随大盒子移动</span></span><br><span class="line"><span class="string">--&gt;</span></span><br><span class="line"><span class="string">&lt;script src="</span>js/jquery<span class="number">-1.11</span><span class="number">.3</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    let $imgList=$('.container&gt;.imgBox&gt;li'),</span></span><br><span class="line"><span class="string">        $mark=null,</span></span><br><span class="line"><span class="string">        $container=$('.container');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    $imgList.on('mouseover',function (ev)&#123;</span></span><br><span class="line"><span class="string">        //=&gt;创建mark,根据经过的li中的小图片,动态管控mark中的大图片</span></span><br><span class="line"><span class="string">        let srcStr=$(this).children('img').attr('src');</span></span><br><span class="line"><span class="string">        //=&gt;加个下划线</span></span><br><span class="line"><span class="string">        srcStr=srcStr.replace(/_(\d+)/g,'_$1_bigger');</span></span><br><span class="line"><span class="string">        if(!$mark)&#123;</span></span><br><span class="line"><span class="string">            $mark=$(` &lt;div class="</span>mark<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;img src="</span>$&#123;srcStr&#125;<span class="string">" alt="</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;`);</span></span><br><span class="line"><span class="string">            $container.append($mark)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;).on('mouseout',function (ev)&#123;</span></span><br><span class="line"><span class="string">            //=&gt;移除mark</span></span><br><span class="line"><span class="string">        if($mark)&#123;</span></span><br><span class="line"><span class="string">            $mark.remove();</span></span><br><span class="line"><span class="string">            $mark=null;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;).on('mousemove',function (ev)&#123;</span></span><br><span class="line"><span class="string">        //=&gt;根据鼠标的位置计算出mark的位置</span></span><br><span class="line"><span class="string">        //container 上左偏移</span></span><br><span class="line"><span class="string">        let &#123;top:conTop,left:conLeft&#125;=$container.offset(),</span></span><br><span class="line"><span class="string">            curL=ev.pageX-conLeft-60;</span></span><br><span class="line"><span class="string">            curT=ev.pageY-conTop+40;</span></span><br><span class="line"><span class="string">        $mark.css(&#123;</span></span><br><span class="line"><span class="string">            left:curL,</span></span><br><span class="line"><span class="string">            top:curT</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>###导航显示<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;珠峰培训&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;link rel="stylesheet" href="css/</span>reset.min.css<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">        html, body &#123;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">            overflow: hidden;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        .menuBox &#123;</span></span><br><span class="line"><span class="string">            margin: 20px auto;</span></span><br><span class="line"><span class="string">            width: 700px;</span></span><br><span class="line"><span class="string">            height: 270px;</span></span><br><span class="line"><span class="string">            border: 1px solid #000;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        .navBox &#123;</span></span><br><span class="line"><span class="string">            float: left;</span></span><br><span class="line"><span class="string">            width: 200px;</span></span><br><span class="line"><span class="string">            background: lightblue;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        .navBox ul li &#123;</span></span><br><span class="line"><span class="string">            height: 30px;</span></span><br><span class="line"><span class="string">            line-height: 30px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        .navBox ul li a &#123;</span></span><br><span class="line"><span class="string">            display: block;</span></span><br><span class="line"><span class="string">            padding: 0 10px;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">            font-size: 14px;</span></span><br><span class="line"><span class="string">            color: #555;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        .navBox ul li a:hover &#123;</span></span><br><span class="line"><span class="string">            background: lightcoral;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        .detailBox &#123;</span></span><br><span class="line"><span class="string">            display: none;</span></span><br><span class="line"><span class="string">            float: left;</span></span><br><span class="line"><span class="string">            width: 500px;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">            background: #EEE;</span></span><br><span class="line"><span class="string">            font-size: 20px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;section class="</span>menuBox<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;nav class="</span>navBox<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;ul&gt;</span></span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航1&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航2&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航3&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航4&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航5&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航6&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航7&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航8&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">            &lt;li&gt;&lt;a href="#" target="_blank"&gt;导航9&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>nav&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"detailBox"</span>&gt;导航<span class="number">1</span>对应的详情内容&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>section&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=<span class="string">"js/jquery-1.11.3.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">//=&gt;基于事件委托给最外层的盒子的MOUSE-OVER绑定方法，这样不管操作后代元素中的谁的MOUSE-OVER，这个方法都会执行</span></span><br><span class="line">    <span class="keyword">let</span> $detailBox = $(<span class="string">'.detailBox'</span>);</span><br><span class="line">    $(<span class="built_in">document</span>.body).on(<span class="string">'mouseover'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> target = ev.target,</span><br><span class="line">            tag = target.tagName,</span><br><span class="line">            $target = $(target),</span><br><span class="line">            $pars = $target.parents();<span class="comment">//=&gt;获取当前事件源的祖先元素</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//=&gt;如果事件源是NAV-BOX中的A或者LI（让DETAIL-BOX显示）</span></span><br><span class="line">        <span class="keyword">let</span> flag = $pars.filter(<span class="string">'.navBox'</span>).length &gt; <span class="number">0</span> ? <span class="literal">true</span> : <span class="literal">false</span>;<span class="comment">//=&gt;TRUE祖先中包含NAV-BOX,FALSE则相反</span></span><br><span class="line">        <span class="keyword">if</span> ((tag === <span class="string">'A'</span> || tag === <span class="string">'LI'</span>) &amp;&amp; flag) &#123;</span><br><span class="line">            <span class="keyword">let</span> val = $target.text().match(<span class="regexp">/\d+/</span>);</span><br><span class="line">            $detailBox.css(<span class="string">'display'</span>, <span class="string">'block'</span>).html(<span class="string">`导航<span class="subst">$&#123;val&#125;</span>对应的内容`</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*//=&gt;如果事件源是DETAIL-BOX或者是它的后代元素，不做处理</span></span><br><span class="line"><span class="comment">        if ($target.hasClass('detailBox') || $pars.filter('.detailBox').length &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">            return;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line"></span><br><span class="line">        $detailBox.css(<span class="string">'display'</span>, <span class="string">'none'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    $detailBox.on(<span class="string">'mouseover'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">        ev.stopPropagation();</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>自己的导航练习<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> menu=<span class="built_in">document</span>.querySelector(<span class="string">'.menu'</span>),</span><br><span class="line">      detailedList=menu.querySelector(<span class="string">'.detailedList'</span>);</span><br><span class="line">  menu.onmouseover=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">let</span> $parents=$(ev.target).parents();</span><br><span class="line">      <span class="keyword">if</span>((ev.target.tagName===<span class="string">'A'</span> ||ev.target.tagName===<span class="string">'LI'</span> || ev.target.classList.contains(<span class="string">'detailedList'</span>)))&#123;</span><br><span class="line">          <span class="keyword">let</span> val=ev.target.innerHTML.match(<span class="regexp">/\d+/g</span>);</span><br><span class="line">          $(detailedList).css(<span class="string">'display'</span>,<span class="string">'block'</span>).html(<span class="string">`导航<span class="subst">$&#123;val&#125;</span>对应的内容`</span>);</span><br><span class="line">          <span class="keyword">return</span> ;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  menu.onmouseout=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">let</span> $parents=$(ev.target).parents();</span><br><span class="line">      <span class="keyword">if</span>(targetev..tagName===<span class="string">'A'</span> ||ev.target.tagName===<span class="string">'LI'</span> ||ev.target.classList.contains(<span class="string">'detailedList'</span>))&#123;</span><br><span class="line">          detailedList.style.display=<span class="string">'none'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>###封装选项卡(无意义)</p>
<blockquote>
<p>原型上的几个方法 :<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*==把公共方法挂载到类的原型上==*/</span></span><br><span class="line">   hasClass(ele, str) &#123;</span><br><span class="line">       <span class="keyword">return</span> ele.className.trim().split(<span class="regexp">/ +/</span>).indexOf(str) &gt;= <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   addClass(ele, str) &#123;</span><br><span class="line">       <span class="comment">//=&gt;hasClass()不能直接调取，需要基于实例调取使用(或者直接基于类来调取使用也可以 TabPlugin.prototype.hasClass())</span></span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">this</span>.hasClass(ele, str)) <span class="keyword">return</span>;</span><br><span class="line">       ele.className += <span class="string">` <span class="subst">$&#123;str&#125;</span>`</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   removeClass(ele, str) &#123;</span><br><span class="line">       <span class="keyword">if</span> (!<span class="keyword">this</span>.hasClass(ele, str)) <span class="keyword">return</span>;</span><br><span class="line">       ele.className = ele.className.trim().split(<span class="regexp">/ +/</span>).filter(<span class="function"><span class="params">item</span> =&gt;</span> item !== str).join(<span class="string">' '</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>###DOM0和DOM2的本质区别</p>
<blockquote>
<p>[事件绑定]<br>[DOM0] </p>
<ul>
<li>每一个元素对象都是对应类 的实例,浏览器天生为其设置了很多私有属性和公有的属性方法 ,而onclick就是其中的一个私有属性 (事件类私有属性,还有很多其他的事情私有属性),这些属性默认值为null </li>
<li>[DOM0事件]绑定的原理 :就是给元素的某一个事件私有属性赋值 (<code>浏览器会建立监听机制</code>, 当我们触发元素的某个行为 .浏览器会自己把<code>属性中赋的值去执行</code>) </li>
<li>触发点击行为 ,只输出一次 ,DOM0事件绑定只允许给当前元素的某个行为绑定一个方法 ,多次绑定 ,后面绑定的内容会替换前面绑定的 , 以最后一次绑定的方法为主  </li>
</ul>
<p>[DOM2] </p>
<ul>
<li><code>addEventListener</code>  || <code>removeEventListener</code> (在Eveent.Target.prototype定义的)</li>
<li>在IE低版本中使用<code>attachEvent</code>处理 <code>box.attachEvent(&#39;onclick&#39;,function ()｛｝)</code></li>
<li>IE 移除 <code>dettachEvent</code> </li>
</ul>
</blockquote>
<p>###DOM2 的 <code>事件池机制</code></p>
<blockquote>
<p>DOM2基于addEventListener 完成事件绑定 ,是基于 <code>事件池机制</code>完成的 </p>
</blockquote>
<blockquote>
<p>事件池是干嘛的 <code>存储监听方法的地方</code><br>如果事件池中存在一个相同的引用地址 , 则不再重新增加<br>当我们触发box的click行为后 , 浏览器会到事件池中,<code>&#39;按照顺序&#39;</code>一次把之前监听的方法执行</p>
<ul>
<li><code>每一个被执行的方法 , 浏览器都会把事件对象传递给它</code></li>
<li><code>方法中的this是当前操作的元素</code></li>
<li><code>执行的方法不会出现重复 (再向事件池增加的时候就去重了)</code></li>
</ul>
<p>浏览器有一个统一的事件池 ,在这个事件池中记录了很多东西</p>
<ul>
<li>1.序号 </li>
<li>2.元素</li>
<li>3.事件类型</li>
<li>4.方法</li>
<li>5.阶段 </li>
</ul>
<p>回到事件池中筛选 : 按照 元素 类型 ,方法 阶段 严格删选 ,如果都一样属于重复 ,只要有一个不一样就不重复 ,重复是不会向事件池中增加的  </p>
<p>DOM2总结 :</p>
<ol>
<li>DOM2事件绑定可以给当前元素的某一个事件行为绑定 <code>&#39;多个不同的方法&#39;</code><br><img src="./2{N`FSL_M3V{JY6EA3ORU.png" alt="Alt text"><br><img src="./1526180317986.png" alt="Alt text"></li>
</ol>
</blockquote>
<p>###DOM2事件绑定的兼容 </p>
<blockquote>
<p>[谷歌 VS IE高版本] : 在移除事件绑定的时候 ,  如果移除操作发生在正要执行的方法之前  (例如 : 点击的时候,正要执行FN8 ,但是在执行FN4的时候,我们把FN8从事件池中移除了) ,谷歌是立即移除生效,第一次也不再执行FN8了 , 而IE是当前本次不生效, 下一次点击才生效,第一次点击还是要执行FN8的 </p>
<p>标准 / IE低版本<br>标准 : addEventListener  /removeEventListener<br>IE : attachEvent  / detachEvent<br><code>标准用的是行为名称 &#39;click&#39;</code> ,而 IE低版本使用是前面加on</p>
<p>结果区别 : </p>
<ol>
<li><p>this问题<br>标准浏览器中,行为触发方法执行, 方法中的this是当前元素本身,IE低版本中this指向了window </p>
</li>
<li><p>重复问题<br>标准浏览器中的事件池是默认去重的 , 同一个元素的同一个事件行为不能出现相同的绑定方法 , 但是IE低版本的事件池机制没有这么完善 ,不能默认去重 ,也就是可以给同一个元素的同一个事件绑定相同的方法了 </p>
</li>
<li><p>顺序问题<br>标准浏览器是按照向事件池中存放的顺序依次执行的,而IE低版本是乱序执行的,没有规律  </p>
</li>
</ol>
<p>IE低版本浏览器出现的所有问题都是由于本身自带的事件池机制不完善导致的 </p>
<p><code>阐述事件在谷歌和IE下的区别</code><br><code>三个区别:1.冒泡传播路径 2.事件独享 3.dom2</code> </p>
</blockquote>
<p>###DOM0事件绑定和DOM2事件绑定的区别 </p>
<blockquote>
<ol>
<li><p>机制不一样<br>DOM0采用的是给私有属性赋值,所以只能绑定一个方法<br>DOM2采用的是事件池机制 ,所以能绑定多个不同的方法 </p>
</li>
<li><p>移除的操作<br>DOM0移除 : box.onlick =null ;<br>DOM2移除 :<code>不要绑定匿名函数,都绑定实名函数</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">box.addEventListener(<span class="string">'onclick'</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>)｛</span></span><br><span class="line"><span class="function">	<span class="title">console</span>.<span class="title">log</span> (<span class="params"><span class="number">1</span></span>)</span></span><br><span class="line"><span class="function">｝)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">box</span>.<span class="title">removeEventListener</span>(<span class="params"><span class="string">'onclick'</span>,function (</span>)｛</span></span><br><span class="line"><span class="function">//=&gt;<span class="title">DOM2</span>在移除的时候,必须清楚要移除的哪一个方法,匿名函数不行</span></span><br><span class="line"><span class="function">	<span class="title">console</span>.<span class="title">log</span> (<span class="params"><span class="number">2</span></span>)</span></span><br><span class="line"><span class="function">｝)</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<blockquote>
<ol start="3">
<li>DOM2事件绑定中增加了一些DOM0无法操作的事件行为 ,例如 : DOMContentLoaded事件 (<code>当页面中的HTML结构加载完成会触发执行</code>)<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">box.addEventListener(<span class="string">'DOMContentLoaded'</span>,fn1);</span><br><span class="line">box.onDOMContentLoaded =fn; <span class="comment">//=&gt;不可以,不支持</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<p>//=&gt; 区分几个onLoad<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="comment">//=&gt;当页面中的资源都加载完成 (HTML结构加载完 ,CSS,js等资源加载完才会触发执行)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//=&gt;window.addEventListener('load',function()&#123;&#125;) 也可以加载多次</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//=&gt;$(document).ready(function ()&#123;&#125;);</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">//=&gt;当前页面中HTML结构加载完成就会执行</span></span><br><span class="line">	<span class="comment">//=&gt;基于DOM2事件绑定的,所以在同一页面中执行多次 (绑定多个不同的方法),当结构加载完成 ,会一次执行这些方法 </span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">他两的区别 :</span><br><span class="line"><span class="comment">//=&gt;1. 能写多次    2.一个基于DOM0一个基于DOM2</span></span><br></pre></td></tr></table></figure></p>
<p>???..=&gt;&gt;&gt;&gt;执行顺序 ??不太理解<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">box.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  box.onclick=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  box.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure></p>
<p>###JQ事件解析<br><code>JQ的事件绑定</code></p>
<pre><code>- `on /off`: 基于DOM2事件绑定实现事件的绑定和移除的 (兼容了所有的浏览器)    (核心方法)
- `one `: 只绑定一次,第一次执行完成后,会把绑定的方法移除了
- `click/mouseover/mouseout...`JQ提供的跨界绑定方法 ,但是这些方法都是基于on /off 完成的
- `delegate`: 事件委托方法 ( 1.7版本以前的方法 : `live`方法)
- `bind/unbind` : 正常绑定
</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>) </span>&#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// $(document).on('click',fn);</span></span><br><span class="line">      <span class="comment">// $(document).off('click',fn);</span></span><br><span class="line">      <span class="comment">// $(document).one('click',fn);</span></span><br><span class="line">      $(<span class="built_in">document</span>).click(fn);</span><br><span class="line">      $(<span class="built_in">document</span>).delegate(<span class="string">'#box'</span>,<span class="string">'click'</span>,fn);<span class="comment">//=&gt;把点击行为委托给document,不管点击文档中的哪一个元素,都会触发文档的点击行为,第一个参数代指事件源是#box我们执行fn这件事</span></span><br><span class="line">      $(<span class="built_in">document</span>).delegate(<span class="string">'a'</span>,<span class="string">'click'</span>,fn2);</span><br><span class="line">  &#125;();</span><br></pre></td></tr></table></figure>
<p>###简单的实现拖拽<br><img src="./1526196324951.png" alt="Alt text"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;link rel="stylesheet" href="css/</span>reset.min.css<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">        html,body&#123;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">            -webkit-user-select: none; //=&gt;禁止用户选中文字</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        /*一般模态框做固定定位*/</span></span><br><span class="line"><span class="string">        /*dialog*/</span></span><br><span class="line"><span class="string">        .diaLogMark&#123;</span></span><br><span class="line"><span class="string">            position: fixed;</span></span><br><span class="line"><span class="string">            top: 0;</span></span><br><span class="line"><span class="string">            left: 0;</span></span><br><span class="line"><span class="string">            width: 100%;</span></span><br><span class="line"><span class="string">            height: 100%;</span></span><br><span class="line"><span class="string">            background: rgba(0,0,0,.2);</span></span><br><span class="line"><span class="string">            z-index: 888;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .diaLogBox &#123;</span></span><br><span class="line"><span class="string">            /*控制盒子在中间我们最好在JS中实现,经过精密的计算,算出具体的top,left,而不是模糊的百分比,这样以后我们在JS中通过修改它的top/left就可以改变位置了*/</span></span><br><span class="line"><span class="string">            position: fixed;</span></span><br><span class="line"><span class="string">            width: 200px;</span></span><br><span class="line"><span class="string">            height: 300px;</span></span><br><span class="line"><span class="string">            background: #fff;</span></span><br><span class="line"><span class="string">            z-index: 999;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .diaLogBox .title&#123;</span></span><br><span class="line"><span class="string">            position: relative;</span></span><br><span class="line"><span class="string">            height: 35px;</span></span><br><span class="line"><span class="string">            line-height: 35px;</span></span><br><span class="line"><span class="string">            padding: 0 10px;</span></span><br><span class="line"><span class="string">            background: #ddd ;</span></span><br><span class="line"><span class="string">            border-bottom:1px solid #333333;</span></span><br><span class="line"><span class="string">            cursor:move;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .diaLogBox .title i &#123;</span></span><br><span class="line"><span class="string">            position: absolute;</span></span><br><span class="line"><span class="string">            right:10px;</span></span><br><span class="line"><span class="string">            top: 50%;</span></span><br><span class="line"><span class="string">            margin-top:-10px;</span></span><br><span class="line"><span class="string">            width: 20px;</span></span><br><span class="line"><span class="string">            height: 20px;</span></span><br><span class="line"><span class="string">            line-height: 20px;</span></span><br><span class="line"><span class="string">            text-align: center;</span></span><br><span class="line"><span class="string">            font-size: 18px;</span></span><br><span class="line"><span class="string">            color: palevioletred;</span></span><br><span class="line"><span class="string">            font-weight: normal;</span></span><br><span class="line"><span class="string">            z-index: 1000;</span></span><br><span class="line"><span class="string">            cursor:pointer;</span></span><br><span class="line"><span class="string">            font-family: "</span>Microsoft JhengHei<span class="string">";</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;!--dialog : 模态框 (弹出框)--&gt;</span></span><br><span class="line"><span class="string">&lt;div class="</span>diaLogMark<span class="string">"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;div class="</span>diaLogBox<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;h3 class="</span>title<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        珠峰培训diaLogBox</span></span><br><span class="line"><span class="string">        &lt;i&gt;x&lt;/i&gt;</span></span><br><span class="line"><span class="string">    &lt;/h3&gt;</span></span><br><span class="line"><span class="string">    &lt;div class="</span>con<span class="string">"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&lt;script src="</span>js/jquery<span class="number">-1.11</span><span class="number">.3</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    $(function ()&#123;</span></span><br><span class="line"><span class="string">        let $diaLogMark=$('.diaLogMark'),</span></span><br><span class="line"><span class="string">            $diaLogBox=$('.diaLogBox'),</span></span><br><span class="line"><span class="string">            $boxTitle=$diaLogBox.find('.title'),</span></span><br><span class="line"><span class="string">            $closeBtn=$boxTitle.find('i');</span></span><br><span class="line"><span class="string">        let winW=$(document).width(),</span></span><br><span class="line"><span class="string">            winH=$(document).height(),</span></span><br><span class="line"><span class="string">            boxW=$diaLogBox.outerWidth();</span></span><br><span class="line"><span class="string">            boxH=$diaLogBox.outerHeight();</span></span><br><span class="line"><span class="string">        //=&gt;1.先让dialog-box在屏幕中间就可以了</span></span><br><span class="line"><span class="string">        let minL=0,</span></span><br><span class="line"><span class="string">            minT=0,</span></span><br><span class="line"><span class="string">            maxL=winW-boxW,</span></span><br><span class="line"><span class="string">            maxT=winH-boxH;</span></span><br><span class="line"><span class="string">        $diaLogBox.css(&#123;</span></span><br><span class="line"><span class="string">            left:(winW-boxW)/2,</span></span><br><span class="line"><span class="string">            top:(winH-boxH)/2</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        //=&gt;2.点击关联按钮让dialog消失</span></span><br><span class="line"><span class="string">        $closeBtn.on('click',function ()&#123;</span></span><br><span class="line"><span class="string">            $diaLogBox.stop().fadeOut(500,()=&gt;&#123;</span></span><br><span class="line"><span class="string">                $diaLogMark.css('display','none');</span></span><br><span class="line"><span class="string">            &#125;)</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        //=&gt;3.实现拖拽效果</span></span><br><span class="line"><span class="string">        /*</span></span><br><span class="line"><span class="string">        *  思路</span></span><br><span class="line"><span class="string">        *       A: 鼠标在H3中按下 (mousedown)证明拖拽开始</span></span><br><span class="line"><span class="string">        *       B: 鼠标在H3中移动 (mousemove)让盒子也跟着移动</span></span><br><span class="line"><span class="string">        *       C :鼠标在H3上松开 (mouseup)证明拖拽结束,此时我们再在H3中移动,不会做任何处理</span></span><br><span class="line"><span class="string">        *</span></span><br><span class="line"><span class="string">        *  */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        //=&gt;鼠标按下做的处理</span></span><br><span class="line"><span class="string">        let dragStart=function (ev)&#123;</span></span><br><span class="line"><span class="string">            //记录鼠标的起始位置和移动过程中的鼠标的位置</span></span><br><span class="line"><span class="string">            //this : H3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                //=&gt;attr:JQ中的设置自定义属性 (属性值最后都是字符串)</span></span><br><span class="line"><span class="string">                //=&gt;基于JQ中的css获取的属性值都是带单位的</span></span><br><span class="line"><span class="string">                this.starX=ev.clientX;</span></span><br><span class="line"><span class="string">                this.starY=ev.clientY;</span></span><br><span class="line"><span class="string">                this.starL=parseFloat($diaLogBox.css('left'));</span></span><br><span class="line"><span class="string">                this.starT=parseFloat($diaLogBox.css('top'));</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            //=&gt;只有按下才会给move行为绑定方法()这H3中移动鼠标才会让其做一些事情</span></span><br><span class="line"><span class="string">            $boxTitle.on('mousemove',dragMove);</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string">        //=&gt;鼠标移动做的处理事情 :鼠标移动,盒子跟着动</span></span><br><span class="line"><span class="string">        let dragMove=function (ev)&#123;</span></span><br><span class="line"><span class="string">            let &#123;starX,starY,starL,starT&#125;=this;</span></span><br><span class="line"><span class="string">            let curL=ev.clientX-starX+starL,</span></span><br><span class="line"><span class="string">                curT=ev.clientY-starY+starT;</span></span><br><span class="line"><span class="string">            curL=curL&lt;minL?minL:(curL&gt;maxL?maxL:curL);</span></span><br><span class="line"><span class="string">            curT=curT&lt;minT?minT:(curT&gt;maxT?maxT:curT);</span></span><br><span class="line"><span class="string">            $diaLogBox.css(&#123;</span></span><br><span class="line"><span class="string">                left:curL,</span></span><br><span class="line"><span class="string">                top:curT</span></span><br><span class="line"><span class="string">            &#125;)</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string">        //=&gt;鼠标离开处理事情</span></span><br><span class="line"><span class="string">        let dragEnd=function ()&#123;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            //=&gt;手指在H3中抬起,证明结束拖拽,我们把move绑定的方法移除,鼠标再移动时,不会变</span></span><br><span class="line"><span class="string">            $boxTitle.off('mousemove',dragMove);</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string">        $boxTitle.mousedown(dragStart);</span></span><br><span class="line"><span class="string">        $boxTitle.mouseup(dragEnd);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br></pre></td></tr></table></figure></p>
<p>####拖拽鼠标丢失的问题 </p>
<blockquote>
<p>拖拽的一个问题 : 当鼠标移动过快 , 盒子需要计算最新的位置,但是计算速度跟不上鼠标的移动,导致鼠标离开盒子 (具体来说离开的了H3) , 而我们的所有方法都是绑定给H3的相关事件行为的 , 鼠标不在H3上 ,不管做什么操作都不会和之前绑定的方法有关<br>[鼠标不在H3上]</p>
<ul>
<li>1.鼠标继续移动,盒子也不动了,因为没有触发H3的mousemove</li>
<li>2.鼠标在H3以外松开,没有触发它的mouseup,也就是诶呦执行取消mousemove绑定方法的操作,此时h3的mousemove还绑定着呢,这样即使你鼠标松开了,我们鼠标重回到h3上,也会触发它的move,让这字跟着走</li>
</ul>
<p>解决问题</p>
<ul>
<li>1.用一根绳子把H3和鼠标栓在一起,这样鼠标就跟着走<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.setCapture();<span class="comment">//=&gt;把当前元素this和鼠标绑在一起</span></span><br><span class="line"><span class="keyword">this</span>.releaseCapture();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>2.鼠标移动再快 ,也不会逃离document,此时我们可以给document的mousemove绑定方法 (给document的mouseup绑定方法dragEnd),只要是在文档中移动或者抬起鼠标,都执行</li>
</ul>
</blockquote>
<p>####通过把dragmove绑定到document上解决</p>
<blockquote>
<p>中间要处理好this传递的问题,把中间的dragmove.bind(this)和dragmove不是一个东西.通过this的自定义属性完成dragmove.bind(this)的传递<br>因为是事件绑定改变this,所以不能用call,call是直接执行<br>自定义属性的适用场合<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> $diaLogMark=$(<span class="string">'.diaLogMark'</span>),</span><br><span class="line">        $diaLogBox=$(<span class="string">'.diaLogBox'</span>),</span><br><span class="line">        $boxTitle=$diaLogBox.find(<span class="string">'.title'</span>),</span><br><span class="line">        $closeBtn=$boxTitle.find(<span class="string">'i'</span>);</span><br><span class="line">    <span class="keyword">let</span> winW=$(<span class="built_in">document</span>).width(),</span><br><span class="line">        winH=$(<span class="built_in">document</span>).height(),</span><br><span class="line">        boxW=$diaLogBox.outerWidth();</span><br><span class="line">    boxH=$diaLogBox.outerHeight();</span><br><span class="line">    <span class="keyword">let</span> minL=<span class="number">0</span>,</span><br><span class="line">        minT=<span class="number">0</span>,</span><br><span class="line">        maxL=winW-boxW,</span><br><span class="line">        maxT=winH-boxH;</span><br><span class="line">    $diaLogBox.css(&#123;</span><br><span class="line">        left:(winW-boxW)/<span class="number">2</span>,</span><br><span class="line">        top:(winH-boxH)/<span class="number">2</span></span><br><span class="line">    &#125;);</span><br><span class="line">    $closeBtn.on(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        $diaLogBox.stop().fadeOut(<span class="number">500</span>,()=&gt;&#123;</span><br><span class="line">            $diaLogMark.css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">let</span> dragStart=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.starX=ev.clientX;</span><br><span class="line">        <span class="keyword">this</span>.starY=ev.clientY;</span><br><span class="line">        <span class="keyword">this</span>.starL=<span class="built_in">parseFloat</span>($diaLogBox.css(<span class="string">'left'</span>));</span><br><span class="line">        <span class="keyword">this</span>.starT=<span class="built_in">parseFloat</span>($diaLogBox.css(<span class="string">'top'</span>));</span><br><span class="line">        <span class="comment">// this.setCapture();//=&gt;把当前元素this和鼠标绑在一起</span></span><br><span class="line">        <span class="comment">// this.releaseCapture();</span></span><br><span class="line"> <span class="comment">//       $('document').on('mousemove',dragMove).on('mouseup',dragEnd);//this :都变为了document了,但是我们在dragmove中使用的this希望是dragStar的this一样是h3</span></span><br><span class="line">        <span class="keyword">this</span>.dragMove=dragMove.bind(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">this</span>.dragEnd=dragEnd.bind(<span class="keyword">this</span>);</span><br><span class="line">      $(<span class="built_in">document</span>).on(<span class="string">'mousemove'</span>,<span class="keyword">this</span>.dragMove).on(<span class="string">'mouseup'</span>,<span class="keyword">this</span>.dragEnd);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> dragMove=<span class="function"><span class="keyword">function</span> (<span class="params">ev</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> &#123;starX,starY,starL,starT&#125;=<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> curL=ev.clientX-starX+starL,</span><br><span class="line">            curT=ev.clientY-starY+starT;</span><br><span class="line">        curL=curL&lt;minL?minL:(curL&gt;maxL?maxL:curL);</span><br><span class="line">        curT=curT&lt;minT?minT:(curT&gt;maxT?maxT:curT);</span><br><span class="line">        $diaLogBox.css(&#123;</span><br><span class="line">            left:curL,</span><br><span class="line">            top:curT</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> dragEnd=<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">        $(<span class="built_in">document</span>).off(<span class="string">'mousemove'</span>,<span class="keyword">this</span>.dragMove).off(<span class="string">'mouseup'</span>,<span class="keyword">this</span>.dragEnd);</span><br><span class="line">    &#125;;</span><br><span class="line">    $boxTitle.mousedown(dragStart);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>###封装drag方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> $diaLogMark = $(<span class="string">'.diaLogMark'</span>),</span><br><span class="line">        $diaLogBox = $(<span class="string">'.diaLogBox'</span>),</span><br><span class="line">        $boxTitle = $diaLogBox.find(<span class="string">'.title'</span>),</span><br><span class="line">        $closeBtn = $boxTitle.find(<span class="string">'i'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;1.先让DIALOG-BOX在屏幕中间</span></span><br><span class="line">    <span class="keyword">let</span> winW = <span class="built_in">document</span>.documentElement.clientWidth,</span><br><span class="line">        winH = <span class="built_in">document</span>.documentElement.clientHeight,</span><br><span class="line">        boxW = $diaLogBox[<span class="number">0</span>].offsetWidth,</span><br><span class="line">        boxH = $diaLogBox[<span class="number">0</span>].offsetHeight;</span><br><span class="line">    $diaLogBox.css(&#123;</span><br><span class="line">        top: (winH - boxH) / <span class="number">2</span>,</span><br><span class="line">        left: (winW - boxW) / <span class="number">2</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;2.点击关闭按钮让DIALOG消失</span></span><br><span class="line">    $closeBtn.on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//=&gt;FADE-OUT:JQ中提供的渐隐动画</span></span><br><span class="line">        $diaLogBox.stop().fadeOut(<span class="number">200</span>, () =&gt; &#123;</span><br><span class="line">            <span class="comment">//=&gt;动画完成</span></span><br><span class="line">            $diaLogMark.css(<span class="string">'display'</span>, <span class="string">'none'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;3.实现拖拽效果</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 思路</span></span><br><span class="line"><span class="comment">     *  A:鼠标在H3中按下(MOUSE-DOWN)证明拖拽开始</span></span><br><span class="line"><span class="comment">     *  B:鼠标在H3中移动(MOUSE-MOVE)让盒子也跟着移动</span></span><br><span class="line"><span class="comment">     *  C:鼠标在H3上松开(MOUSE-UP)证明拖拽结束,此时我们再在H3中移动,不做任何的处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;鼠标按下处理的事情：记录鼠标的起始位置和盒子的起始位置，在移动的过程中需要使用</span></span><br><span class="line">    <span class="keyword">let</span> dragStart = <span class="function"><span class="keyword">function</span> <span class="title">dragStart</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//=&gt;this:H3</span></span><br><span class="line">        <span class="comment">/* $(this).attr(&#123;</span></span><br><span class="line"><span class="comment">            //=&gt;ATTR：JQ中设置自定义属性（属性值最后都是字符串）</span></span><br><span class="line"><span class="comment">            //=&gt;CSS：基于JQ中的CSS获取的样式属性值是带着单位的(13PX)</span></span><br><span class="line"><span class="comment">            starX: ev.clientX,</span></span><br><span class="line"><span class="comment">            starY: ev.clientY,</span></span><br><span class="line"><span class="comment">            starL: parseFloat($diaLogBox.css('left')),</span></span><br><span class="line"><span class="comment">            starT: parseFloat($diaLogBox.css('top'))</span></span><br><span class="line"><span class="comment">        &#125;);*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//=&gt;基于普通对象的方式设置自定义属性,获取的时候THIS.XXX获取即可</span></span><br><span class="line">        <span class="keyword">this</span>.starX = ev.clientX;</span><br><span class="line">        <span class="keyword">this</span>.starY = ev.clientY;</span><br><span class="line">        <span class="keyword">this</span>.starL = <span class="built_in">parseFloat</span>($diaLogBox.css(<span class="string">'left'</span>));</span><br><span class="line">        <span class="keyword">this</span>.starT = <span class="built_in">parseFloat</span>($diaLogBox.css(<span class="string">'top'</span>));</span><br><span class="line"></span><br><span class="line">        $boxTitle.on(<span class="string">'mousemove'</span>, dragMove);<span class="comment">//=&gt;只有按下后才会给MOVE行为绑定方法（在H3中移动鼠标才会让其做一些事情）</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;鼠标移动处理的事情:让盒子跟随鼠标一起移动(边界判断)</span></span><br><span class="line">    <span class="keyword">let</span> dragMove = <span class="function"><span class="keyword">function</span> <span class="title">dragMove</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//=&gt;this:H3</span></span><br><span class="line">        <span class="comment">//=&gt;随时根据鼠标的当前位置，减去起始的鼠标位置，计算出鼠标的偏移值，用偏移值加上盒子的起始位置，算出盒子的当前位置</span></span><br><span class="line">        <span class="keyword">let</span> &#123;starX, starY, starL, starT&#125; = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">let</span> curL = ev.clientX - starX + starL,</span><br><span class="line">            curT = ev.clientY - starY + starT;</span><br><span class="line">        $diaLogBox.css(&#123;</span><br><span class="line">            left: curL,</span><br><span class="line">            top: curT</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//=&gt;鼠标离开处理的事情</span></span><br><span class="line">    <span class="keyword">let</span> dragEnd = <span class="function"><span class="keyword">function</span> <span class="title">dragEnd</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $boxTitle.off(<span class="string">'mousemove'</span>, dragMove);<span class="comment">//=&gt;手指在H3中抬起，证明结束拖拽，我们把给MOVE绑定的方法移除，这样让鼠标再运动的时候，盒子也不会处理</span></span><br><span class="line">    &#125;;</span><br><span class="line">    $boxTitle.mousedown(dragStart);</span><br><span class="line">    $boxTitle.mouseup(dragEnd);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>###H5中的drag (自己扩展)</p>
<p>###JQ的发布订阅<br><code>发布订阅设计模式(观察者模式)</code><br> 思想 : 准备一个容器,把到达指定时候要处理的事情,事先一一的增加到容器中 (发布计划并且向计划表中订阅方法) , 当到达指定时间点,通知容器中的方法一次执行即可<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> $plan=$.Callbacks();<span class="comment">//=&gt;创建一个空的计划表:空容器 =&gt;$plan</span></span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">	$plan.fire(<span class="number">10</span>,<span class="number">20</span>)<span class="comment">//=&gt;fire就是通知容器中的方法按照顺序依次执行</span></span><br><span class="line">	<span class="comment">//=&gt;执行容器中的每一个方法的时候,都给他们传递两个参数值</span></span><br><span class="line">&#125;,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//=&gt;add是向容器中增加方法  remove是从容器中移除方法</span></span><br><span class="line">$plan.add(<span class="function">(<span class="params">x,y</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line">$plan.add(<span class="function">(<span class="params">x,y</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br><span class="line">$plan.add(<span class="function">(<span class="params">x,y</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>###bind方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">x, y, ev</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>, x, y, ev);</span><br><span class="line">    <span class="keyword">this</span>.val = x + y;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">name</span>: <span class="string">'珠峰'</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// document.body.onclick = fn;//=&gt;FN中的THIS:BODY  X是事件对象  Y是UNDEFINED  //=&gt;需求:触发BODY的点击事件,执行FN,但是需要让FN中的THIS是OBJ,并且给FN传递一个10&amp;20,而且在FN中还需要得到事件对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// document.body.onclick = fn.bind(obj, 10, 20);//=&gt;基于FUNCTION.PROTOTYPE上的BIND方法可以预先处理THIS，还可以给函数预先传递参数，而且还可以把事件对象等信息最后传递给函数...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//=&gt;在外层包裹一层匿名函数，就可以实现类似于BIND的效果（因为BIND就是这样搞的）</span></span><br><span class="line"><span class="comment">// document.body.onclick = function anonymous(ev) &#123;</span></span><br><span class="line"><span class="comment">//     //=&gt;THIS:BODY EV:事件对象</span></span><br><span class="line"><span class="comment">//     //=&gt;我们的需求是执行FN</span></span><br><span class="line"><span class="comment">//     fn.call(obj, 10, 20, ev);</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span> <span class="title">myBind</span>(<span class="params">context, ...arg</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//=&gt;THIS:FN(当前需要处理的函数)</span></span><br><span class="line">    <span class="comment">//=&gt;CONTEXT:OBJ(需要把FN中的THIS改为谁就传递谁)</span></span><br><span class="line">    <span class="comment">//=&gt;ARG:需要传递给FN的实参(数组) [10,20]</span></span><br><span class="line">    <span class="keyword">let</span> _this = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">anonymous</span>(<span class="params">...innerArg</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//=&gt;INNER-ARG:可能有值,可能没有值,如果把BIND返回的结果给元素的事件绑定,则事件触发,执行这个匿名函数,会把事件对象传递进来 [ev]</span></span><br><span class="line">        <span class="comment">//=&gt;最后的目的是把FN执行,把THIS改成OBJ,把参数传递给FN即可</span></span><br><span class="line">        _this.apply(context, arg.concat(innerArg));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">document</span>.body.onclick = fn.myBind(obj, <span class="number">10</span>, <span class="number">20</span>);<span class="comment">//=&gt;首先找到原型上的BIND，在BIND方法执行的时候，把FN中的信息进行预先处理</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 执行BIND形成一个不销毁的私有栈内存(AAA)，返回一个新的匿名函数(每一次返回的不一样:不是相同的堆内存)</span></span><br><span class="line"><span class="comment"> *   [存储的内容]</span></span><br><span class="line"><span class="comment"> *      //=&gt;THIS:FN(当前需要处理的函数)</span></span><br><span class="line"><span class="comment">        //=&gt;CONTEXT:OBJ(需要把FN中的THIS改为谁就传递谁)</span></span><br><span class="line"><span class="comment">        //=&gt;ARG:需要传递给FN的实参(数组)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   document.body.onclick = function anonymous(ev) &#123;&#125; 当我们触发BODY的点击行为，执行的是返回的匿名函数</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/14/week five/" data-id="cjh62ky3h0000s4o0qbbw2kh8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/05/14/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/14/week five/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/05/14/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>